version: 0.1
phases:
  install:
    commands:
      - curl https://raw.githubusercontent.com/golang/dep/master/install.sh | sh
  pre_build:
    commands:
      - dep ensure
      - mkdir -p .aws/lambda
  build:
    commands:
      - go build -o .aws/lambda/commbot cli.go
      - zip $S3_KEY .aws/lambda/commbot
  post_build:
    commands:
      - aws s3 cp "$S3_KEY" "s3://$S3_BUCKET/$S3_KEY" 