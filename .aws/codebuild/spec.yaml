version: 0.2
phases:
  install:
    commands:
      - ln -s ${CODEBUILD_SRC_DIR} ${GOPATH}/src/${PACKAGE}
      - cd ${GOPATH}/src/${PACKAGE}
  pre_build:
    commands:
      - dep ensure
  build:
    commands:
      - go build -o .aws/lambda/commbot cli.go
  post_build:
    commands:
      - zip ${S3_KEY} .aws/lambda/commbot
      - aws s3 cp "${S3_KEY}" "s3://${S3_BUCKET}/${S3_KEY}" 